<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:sec="http://www.w3.org/1999/xhtml"
      layout:decorate="~{/test/layout}">

<th:block layout:fragment="script">
    <!-- ÌïÑÏöîÌïú Ïä§ÌÉÄÏùºÏãúÌä∏ Î∞è Ïä§ÌÅ¨Î¶ΩÌä∏Î•º Î°úÎìúÌï©ÎãàÎã§. -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@0.7.0"></script>

</th:block>
<div layout:fragment="content">

    <!-- Î©îÏù∏ÌéòÏù¥ÏßÄ -->
    <div class="container-fluid" style="max-width: 2000px">

        <!-- ÌïúÏ§Ñ ÏöîÏïΩ -->
        <div class="row">
            <!-- ÏùºÍ∞Ñ Ï¥ù Îß§Ï∂úÏï° -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-primary shadow h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-primary text-uppercase mb-1" style="font-size: 20px;">
                                    ÏùºÍ∞Ñ Ï¥ù Îß§Ï∂úÏï°
                                </div>
                                <div style="margin-top:10px; margin-bottom: 10px;">
                                    <h3 class="hw-light text-black" th:if="${daily == 0}">Îß§Ï∂ú ÌôïÏù∏ Ï§ë</h3>
                                    <div th:if="${compareLstDaily > 0}">
                                        <h3 class="hw-light text-black" style="display : inline;"
                                            data-th-text="${#numbers.formatInteger(daily, 3, 'COMMA') + 'Ïõê'}"></h3>
                                        <span style="color : red"
                                              th:text="${#numbers.formatDecimal(compareLstDaily, 1, 1)} + '% üìà'"></span>
                                    </div>
                                    <div th:unless="${compareLstDaily > 0}">
                                        <h3 class="hw-light text-black" style="display : inline;"
                                            data-th-text="${#numbers.formatInteger(daily, 3, 'COMMA') + 'Ïõê'}"></h3>
                                        <span style="color : blue"
                                              th:text="${#numbers.formatDecimal(compareLstDaily, 1, 1)} + '% üìâ' "></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-dollar-sign fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ï£ºÍ∞Ñ Ï¥ù Îß§Ï∂úÏï° -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-success shadow h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-success text-uppercase mb-1" style="font-size: 20px;">
                                    Ï£ºÍ∞Ñ Ï¥ù Îß§Ï∂úÏï°
                                </div>
                                <div style="margin-top:10px; margin-bottom: 10px;">
                                    <div th:if="${compareLstWeek > 0}">
                                        <h3 class="hw-light text-black" style="display : inline;"
                                            data-th-text="${#numbers.formatInteger(week, 3, 'COMMA') + 'Ïõê'}"></h3>
                                        <span style="color : red"
                                              th:text="${#numbers.formatDecimal(compareLstWeek, 1, 1)} + '% üìà'"></span>
                                    </div>
                                    <div th:unless="${compareLstWeek > 0}">
                                        <h3 class="hw-light text-black" style="display : inline;"
                                            data-th-text="${#numbers.formatInteger(week, 3, 'COMMA') + 'Ïõê'}"></h3>
                                        <span style="color : blue"
                                              th:text="${#numbers.formatDecimal(compareLstWeek, 1, 1)} + '% üìâ' "></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-dollar-sign fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ÏõîÍ∞Ñ Ï¥ù Îß§Ï∂úÏï° -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-info shadow h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-info text-uppercase mb-1" style="font-size: 20px;">
                                    ÏõîÍ∞Ñ Ï¥ù Îß§Ï∂úÏï°
                                </div>
                                <div style="margin-top:10px; margin-bottom: 10px;">
                                    <div th:if="${compareLstMonth > 0}">
                                        <h3 class="hw-light text-black" style="display : inline;"
                                            data-th-text="${#numbers.formatInteger(month, 3, 'COMMA') + 'Ïõê'}"></h3>
                                        <span style="color : red"
                                              th:text="${#numbers.formatDecimal(compareLstMonth, 1, 1)} + '% üìà'"></span>
                                    </div>
                                    <div th:unless="${compareLstMonth > 0}">
                                        <h3 class="hw-light text-black" style="display : inline;"
                                            data-th-text="${#numbers.formatInteger(month, 3, 'COMMA') + 'Ïõê'}"></h3>
                                        <span style="color : blue"
                                              th:text="${#numbers.formatDecimal(compareLstMonth, 1, 1)} + '% üìâ' "></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-dollar-sign fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ÏßÄÏ†ê Ïàò -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-warning shadow h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div sec:authorize="hasRole('ADMIN')">
                                    <div class="text-xs font-weight-bold text-warning text-uppercase mb-1" style="font-size: 20px;">
                                        Ï†ÑÏ≤¥ ÏßÄÏ†ê Ïàò
                                    </div>
                                    <h3 class="hw-light text-black" style="margin-top: 15px;" th:text="${count}"></h3>
                                </div>
                                <div  sec:authorize="hasRole('USER')">
                                    <div class="text-xs font-weight-bold text-warning text-uppercase mb-1" style="font-size: 20px;">
                                        Í∏àÏùº Ï£ºÎ¨∏Îüâ
                                    </div>
                                    <h3 class="hw-light text-black" style="margin-top: 15px;" th:text="${todaysOrderCount}"></h3>
                                </div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-store fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Í∑∏ÎûòÌîÑ ÏöîÏïΩ -->

        <!-- ÏõîÎ≥Ñ Ï¥ù Îß§Ï∂ú -->
        <div class="row">
            <div class="col-xl-8 col-lg-7">
                <div sec:authorize="hasRole('ADMIN')">
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">ÏõîÎ≥Ñ Ï¥ù Îß§Ï∂ú</h6>
                        </div>
                        <div class="card-body">
                            <div class="chart-area">
                                <!-- Chart.js Í∑∏ÎûòÌîÑÎ•º ÌëúÏãúÌï† Ï∫îÎ≤ÑÏä§ -->
                                <canvas id="monthChart" style="width:800px; height: 200px"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div sec:authorize="hasRole('USER')">
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">ÏõîÎ≥Ñ Ï¥ù Îß§Ï∂ú</h6>
                        </div>
                        <div class="card-body">
                            <div class="chart-area">
                                <!-- Chart.js Í∑∏ÎûòÌîÑÎ•º ÌëúÏãúÌï† Ï∫îÎ≤ÑÏä§ -->
                                <canvas id="monthChartByBranch" style="width:800px; height: 200px"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!--     ADMIN     -->
                <script th:inline="javascript">
                    document.addEventListener('DOMContentLoaded', function() {
                        console.log(/*[[${monthlySalesData}]]*/);
                        var dataPoints = /*[[${monthlySalesData}]]*/;
                        var ctx = document.getElementById('monthChart').getContext('2d');
                        var monthChart = new Chart(ctx, {
                            type: 'line', // Change from 'bar' to 'line'
                            data: {
                                labels: ['1Ïõî','2Ïõî','3Ïõî','4Ïõî','5Ïõî','6Ïõî','7Ïõî','8Ïõî','9Ïõî','10Ïõî','11Ïõî','12Ïõî'],
                                datasets: [{
                                    label: 'Îß§Ï∂ú',
                                    data: dataPoints.map(item => item[1]), // Use your actual data here
                                    backgroundColor: `rgba(54, 162, 235, 0.2)`, // Adjust for line chart
                                    borderColor: `rgba(54, 162, 235, 1)`, // Adjust for line chart
                                    borderWidth: 2,
                                    fill: false, // Ensures the area under the line isn't filled
                                    pointBackgroundColor: '#fff', // Color of the points on the line
                                    pointBorderColor: `rgba(54, 162, 235, 1)`, // Border color of the points
                                    pointHoverBackgroundColor: `rgba(54, 162, 235, 1)`, // Hover color of the points
                                    pointHoverBorderColor: '#fff', // Hover border color of the points
                                }]
                            },
                            options: {
                                responsive: true,
                                scales: {
                                    y: {
                                        // YÏ∂ïÏùò ÌëúÏãú ÌòïÏãùÏùÑ Ïª§Ïä§ÌÑ∞ÎßàÏù¥Ïßï
                                        callback: function(value, index, values) {
                                            return value.toLocaleString(); // YÏ∂ïÏùò Í∞íÏóê ÏâºÌëú Ìè¨Ìï®
                                        }
                                    },
                                    x: { // Update for Chart.js 3
                                        grid: {
                                            display: false // Hides the grid lines for x-axis
                                        }
                                    }
                                },
                                plugins: {
                                    datalabels: {
                                        align: 'end',
                                        anchor: 'end',
                                        formatter: function(value, context) {
                                            return value.toLocaleString(); // Ïà´ÏûêÏóê ÏâºÌëú Ï∂îÍ∞Ä
                                        }
                                    }
                                },
                                tooltips: { // Chart.js 2.x Î≤ÑÏ†ÑÏóêÏÑúÎäî tooltips ÏòµÏÖò, 3.x Ïù¥ÏÉÅ Î≤ÑÏ†ÑÏóêÏÑúÎäî plugins.tooltip ÏÇ¨Ïö©
                                    callbacks: {
                                        // Ìà¥ÌåÅÏóê ÌëúÏãúÎêòÎäî ÌÖçÏä§Ìä∏ ÌòïÏãùÏùÑ Ïª§Ïä§ÌÑ∞ÎßàÏù¥Ïßï
                                        label: function(tooltipItem, chart) {
                                            var datasetLabel = chart.datasets[tooltipItem.datasetIndex].label || '';
                                            return datasetLabel + ': ' + tooltipItem.yLabel.toLocaleString();
                                        }
                                    }
                                }
                            }
                        });
                    });
                </script>

                <!--     USER      -->
                <script th:inline="javascript">
                    document.addEventListener('DOMContentLoaded', function() {
                        console.log(/*[[${monthlySalesDataByBranch}]]*/);
                        var dataPointsByBranch = /*[[${monthlySalesDataByBranch}]]*/;
                        var ctx = document.getElementById('monthChartByBranch').getContext('2d');
                        var monthChartByBranch = new Chart(ctx, {
                            type: 'line', // Change from 'bar' to 'line'
                            data: {
                                labels: ['1Ïõî','2Ïõî','3Ïõî','4Ïõî','5Ïõî','6Ïõî','7Ïõî','8Ïõî','9Ïõî','10Ïõî','11Ïõî','12Ïõî'],
                                datasets: [{
                                    label: 'Îß§Ï∂ú',
                                    data: dataPointsByBranch.map(item => item[1]), // Use your actual data here
                                    backgroundColor: `rgba(54, 162, 235, 0.2)`, // Adjust for line chart
                                    borderColor: `rgba(54, 162, 235, 1)`, // Adjust for line chart
                                    borderWidth: 2,
                                    fill: false, // Ensures the area under the line isn't filled
                                    pointBackgroundColor: '#fff', // Color of the points on the line
                                    pointBorderColor: `rgba(54, 162, 235, 1)`, // Border color of the points
                                    pointHoverBackgroundColor: `rgba(54, 162, 235, 1)`, // Hover color of the points
                                    pointHoverBorderColor: '#fff', // Hover border color of the points
                                }]
                            },
                            options: {
                                responsive: true,
                                scales: {
                                    y: { // Update for Chart.js 3
                                        beginAtZero: true
                                    },
                                    x: { // Update for Chart.js 3
                                        grid: {
                                            display: false // Hides the grid lines for x-axis
                                        }
                                    }
                                },
                                plugins: {
                                    datalabels: {
                                        align: 'end',
                                        anchor: 'end',
                                        formatter: function(value, context) {
                                            return value.toLocaleString(); // Ïà´ÏûêÏóê ÏâºÌëú Ï∂îÍ∞Ä
                                        }
                                    }
                                },
                                tooltips: { // Chart.js 2.x Î≤ÑÏ†ÑÏóêÏÑúÎäî tooltips ÏòµÏÖò, 3.x Ïù¥ÏÉÅ Î≤ÑÏ†ÑÏóêÏÑúÎäî plugins.tooltip ÏÇ¨Ïö©
                                    callbacks: {
                                        // Ìà¥ÌåÅÏóê ÌëúÏãúÎêòÎäî ÌÖçÏä§Ìä∏ ÌòïÏãùÏùÑ Ïª§Ïä§ÌÑ∞ÎßàÏù¥Ïßï
                                        label: function(tooltipItem, chart) {
                                            var datasetLabel = chart.datasets[tooltipItem.datasetIndex].label || '';
                                            return datasetLabel + ': ' + tooltipItem.yLabel.toLocaleString();
                                        }
                                    }
                                }
                            }
                        });
                    });
                </script>

                <!--    ADMIN     -->
                <script th:inline="javascript">

                    document.addEventListener('DOMContentLoaded', function() {
                        // ÏÑúÎ≤ÑÎ°úÎ∂ÄÌÑ∞ Î∞õÏùÄ topSalesBranches Îç∞Ïù¥ÌÑ∞ Î°úÍ∑∏ Ï∂úÎ†•
                        // console.log(/*[[${topSalesBranches}]]*/);

                        var labels = /*[[${topSalesBranches}]]*/; // ÏßÄÏ†êÎ™ÖÏùÑ Î†àÏù¥Î∏îÎ°ú ÏÇ¨Ïö©
                        var data = /*[[${topSalesBranches}]]*/; // Í∞Å ÏßÄÏ†êÏùò Îß§Ï∂úÏï°ÏùÑ Îç∞Ïù¥ÌÑ∞Î°ú ÏÇ¨Ïö©

                        var ctx = document.getElementById('topSalesBranchesChart').getContext('2d');
                        var topSalesBranchesChart = new Chart(ctx, {
                            type: 'bar', // Ï∞®Ìä∏ ÌÉÄÏûÖÏùÑ 'bar'Î°ú ÏÑ§Ï†ïÌïòÏó¨ ÎßâÎåÄ Ï∞®Ìä∏Î•º ÏÉùÏÑ±
                            data: {
                                labels: labels.map(branch => branch[1]),
                                datasets: [{
                                    label: 'Îß§Ï∂ú',
                                    data: data.map(branch => branch[2]),
                                    backgroundColor: [
                                        'rgba(255, 0, 0, 1)',
                                        'rgba(0, 128, 0, 1)',
                                        'rgba(0, 0, 255, 1)',
                                        'rgba(255, 165, 0, 1)',
                                        'rgba(128, 0, 128, 1)',
                                        'rgba(255, 255, 0, 1)',
                                        'rgba(0, 255, 255, 1)',
                                        'rgba(255, 20, 147, 1)',
                                        'rgba(0, 100, 0, 1)',
                                        'rgba(139, 0, 0, 1)'
                                    ],
                                    borderColor: [
                                        'rgba(255, 0, 0, 0.6)',   // Red
                                        'rgba(0, 128, 0, 0.6)',   // Green
                                        'rgba(0, 0, 255, 0.6)',   // Blue
                                        'rgba(255, 165, 0, 0.6)', // Orange
                                        'rgba(128, 0, 128, 0.6)', // Purple
                                        'rgba(255, 255, 0, 0.6)', // Yellow
                                        'rgba(0, 255, 255, 0.6)', // Cyan
                                        'rgba(255, 20, 147, 0.6)',// Pink
                                        'rgba(0, 100, 0, 0.6)',   // DarkGreen
                                        'rgba(139, 0, 0, 0.6)'    // DarkRed
                                    ],
                                    borderWidth: 1
                                }]
                            },
                            options: {
                                plugins: {
                                    legend: {
                                        display: false // Î≤îÎ°Ä Ïà®Í∏∞Í∏∞
                                    },
                                    datalabels: {
                                        display: false, // Ïù¥ Ï∞®Ìä∏ÏóêÏÑúÎßå Îç∞Ïù¥ÌÑ∞ Î†àÏù¥Î∏î ÌôúÏÑ±Ìôî
                                        // Îç∞Ïù¥ÌÑ∞ Î†àÏù¥Î∏î ÏÑ§Ï†ï...
                                    }
                                },
                                responsive: true,
                                scales: {
                                    y: {
                                        beginAtZero: true
                                    }
                                },
                                tooltips: { // Chart.js 2.x Î≤ÑÏ†ÑÏóêÏÑúÎäî tooltips ÏòµÏÖò, 3.x Ïù¥ÏÉÅ Î≤ÑÏ†ÑÏóêÏÑúÎäî plugins.tooltip ÏÇ¨Ïö©
                                    callbacks: {
                                        // Ìà¥ÌåÅÏóê ÌëúÏãúÎêòÎäî ÌÖçÏä§Ìä∏ ÌòïÏãùÏùÑ Ïª§Ïä§ÌÑ∞ÎßàÏù¥Ïßï
                                        label: function(tooltipItem, chart) {
                                            var datasetLabel = chart.datasets[tooltipItem.datasetIndex].label || '';
                                            return datasetLabel + ': ' + tooltipItem.yLabel.toLocaleString();
                                        }
                                    }
                                }
                            }
                        });
                    });
                </script>

                <!-- ÏßÄÏ†ê Îß§Ï∂ú ÏàúÏúÑ TOP 10 -->
                <div sec:authorize="hasRole('ADMIN')">
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">ÏõîÎ≥Ñ ÏßÄÏ†ê Îß§Ï∂ú ÏàúÏúÑ TOP 10</h6>
                        </div>
                        <div class="card-body">
                            <div class="chart-bar" style="margin-bottom: 1.5%;">
                                <canvas id="topSalesBranchesChart" style="width:800px; height: 200px"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Í∞ÄÏû• ÎßéÏù¥ ÌåîÎ¶∞ Î©îÎâ¥ -->
            <div class="col-xl-4 col-lg-5">
                <div class="card shadow mb-4">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary">ÏõîÎ≥Ñ Î≤†Ïä§Ìä∏ Î©îÎâ¥ TOP 5</h6>
                    </div>
                    <div class="card-body"  style="height: 351.98px">
                        <div sec:authorize="hasRole('USER')" class="chart-pie pt-4" style="margin-bottom: 80%;">
                            <canvas id="topSoldItemsByBranchChart" style="height: 200px"></canvas>
                        </div>
                        <div sec:authorize="hasRole('ADMIN')" class="chart-pie pt-4" style="margin-bottom: 80%;">
                            <canvas id="topSoldItemsChart" style="height: 200px"></canvas>
                        </div>
                    </div>
                </div>
                <!--    ADMIN     -->
                <script th:inline="javascript">
                    document.addEventListener('DOMContentLoaded', function() {
                        // ÏÑúÎ≤ÑÎ°úÎ∂ÄÌÑ∞ Î∞õÏùÄ topSoldItems Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨
                        var topSoldItems = /*[[${topSoldItems}]]*/ [];

                        // Îç∞Ïù¥ÌÑ∞ÏóêÏÑú Î†àÏù¥Î∏î(Î©îÎâ¥ Ïù¥Î¶Ñ)Í≥º Îç∞Ïù¥ÌÑ∞(ÌåêÎß§ ÏàòÎüâ) Ï∂îÏ∂ú
                        var labels = topSoldItems.map(item => item[0]);
                        var data = topSoldItems.map(item => item[1]);

                        var ctx = document.getElementById('topSoldItemsChart').getContext('2d');
                        var topSoldItemsChart = new Chart(ctx, {
                            type: 'doughnut', // Ï∞®Ìä∏ ÌÉÄÏûÖÏùÑ 'doughnut'Î°ú ÏÑ§Ï†ï
                            data: {
                                labels: labels, // Ï∂îÏ∂úÌïú Î†àÏù¥Î∏î ÏÇ¨Ïö©
                                datasets: [{
                                    label: 'Top Sold Items',
                                    data: data, // Ï∂îÏ∂úÌïú Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
                                    backgroundColor: [
                                        'rgba(255, 0, 0, 1)',
                                        'rgba(0, 128, 0, 1)',
                                        'rgba(0, 0, 255, 1)',
                                        'rgba(255, 165, 0, 1)',
                                        'rgba(128, 0, 128, 1)',
                                        // ÌïÑÏöîÌïú ÎßåÌÅº ÏÉâÏÉÅ Ï∂îÍ∞Ä
                                    ],
                                    borderColor: [
                                        'rgba(255, 0, 0, 0.8)',   // Red
                                        'rgba(0, 128, 0, 0.8)',   // Green
                                        'rgba(0, 0, 255, 0.8)',   // Blue
                                        'rgba(255, 165, 0, 0.8)', // Orange
                                        'rgba(128, 0, 128, 0.8)', // Purple
                                        // ÌïÑÏöîÌïú ÎßåÌÅº ÌÖåÎëêÎ¶¨ ÏÉâÏÉÅ Ï∂îÍ∞Ä
                                    ],
                                    borderWidth: 1
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    datalabels: {
                                        color: '#fff',
                                        anchor: 'end',
                                        align: 'start',
                                        formatter: (value, ctx) => {
                                            let sum = ctx.dataset._meta[Object.keys(ctx.dataset._meta)[0]].total;
                                            let percentage = (value / sum * 100).toFixed(2) + "%";
                                            return percentage;
                                        }
                                    }
                                },
                                legend: {
                                    position: 'top',
                                },
                                animation: {
                                    animateScale: true,
                                    animateRotate: true
                                }
                            }
                        });
                    });
                </script>

                <!--    USER     -->
                <script th:inline="javascript">
                    document.addEventListener('DOMContentLoaded', function() {
                        // ÏÑúÎ≤ÑÎ°úÎ∂ÄÌÑ∞ Î∞õÏùÄ topSoldItems Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨
                        var topSoldItemsByBranch = /*[[${topSoldItemsByBranch}]]*/ [];

                        // Îç∞Ïù¥ÌÑ∞ÏóêÏÑú Î†àÏù¥Î∏î(Î©îÎâ¥ Ïù¥Î¶Ñ)Í≥º Îç∞Ïù¥ÌÑ∞(ÌåêÎß§ ÏàòÎüâ) Ï∂îÏ∂ú
                        var labels = topSoldItemsByBranch.map(item => item[0]);
                        var data = topSoldItemsByBranch.map(item => item[1]);

                        var ctx = document.getElementById('topSoldItemsByBranchChart').getContext('2d');
                        var topSoldItemsByBranchChart = new Chart(ctx, {
                            type: 'doughnut', // Ï∞®Ìä∏ ÌÉÄÏûÖÏùÑ 'doughnut'Î°ú ÏÑ§Ï†ï
                            data: {
                                labels: labels, // Ï∂îÏ∂úÌïú Î†àÏù¥Î∏î ÏÇ¨Ïö©
                                datasets: [{
                                    label: 'Top Sold Items',
                                    data: data, // Ï∂îÏ∂úÌïú Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
                                    backgroundColor: [
                                        'rgba(255, 0, 0, 1)',
                                        'rgba(0, 128, 0, 1)',
                                        'rgba(0, 0, 255, 1)',
                                        'rgba(255, 165, 0, 1)',
                                        'rgba(128, 0, 128, 1)',
                                        // ÌïÑÏöîÌïú ÎßåÌÅº ÏÉâÏÉÅ Ï∂îÍ∞Ä
                                    ],
                                    borderColor: [
                                        'rgba(255, 0, 0, 0.8)',   // Red
                                        'rgba(0, 128, 0, 0.8)',   // Green
                                        'rgba(0, 0, 255, 0.8)',   // Blue
                                        'rgba(255, 165, 0, 0.8)', // Orange
                                        'rgba(128, 0, 128, 0.8)', // Purple
                                        // ÌïÑÏöîÌïú ÎßåÌÅº ÌÖåÎëêÎ¶¨ ÏÉâÏÉÅ Ï∂îÍ∞Ä
                                    ],
                                    borderWidth: 1
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    datalabels: {
                                        color: '#fff',
                                        anchor: 'end',
                                        align: 'start',
                                        formatter: (value, ctx) => {
                                            let sum = ctx.dataset._meta[Object.keys(ctx.dataset._meta)[0]].total;
                                            let percentage = (value / sum * 100).toFixed(2) + "%";
                                            return percentage;
                                        }
                                    }
                                },
                                legend: {
                                    position: 'top',
                                },
                                animation: {
                                    animateScale: true,
                                    animateRotate: true
                                }
                            }
                        });
                    });
                </script>

                <!-- Ï†ÑÍµ≠ ÏßÄÏ†ê -->
<!--                <div sec:authorize="hasRole('ADMIN')">-->
<!--                    <div class="card shadow mb-4" style="height:47%;">-->
<!--                        <div class="card-header py-3">-->
<!--                            <h6 class="m-0 font-weight-bold text-primary">ÏßÄÎ¶¨Ï†Å Îß§Ï∂ú Î∂ÑÏÑù</h6>-->
<!--                        </div>-->
<!--                        <div class="card-body">-->
<!--                            <div id="visualization"></div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
            </div>
        </div>
    </div>
</div>
</html>